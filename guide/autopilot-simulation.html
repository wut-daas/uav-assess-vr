<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Autopilot simulation | UAV Assess VR</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="Visualisation and evaluation of UAV operator&#39;s performance based on received MAVLink stream">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    
    <link rel="preload" href="/uav-assess-vr/assets/css/0.styles.1a197325.css" as="style"><link rel="preload" href="/uav-assess-vr/assets/js/app.d990a396.js" as="script"><link rel="preload" href="/uav-assess-vr/assets/js/2.f9356c91.js" as="script"><link rel="preload" href="/uav-assess-vr/assets/js/18.611d644b.js" as="script"><link rel="prefetch" href="/uav-assess-vr/assets/js/10.de5d2a16.js"><link rel="prefetch" href="/uav-assess-vr/assets/js/11.84c05331.js"><link rel="prefetch" href="/uav-assess-vr/assets/js/12.0ffc1125.js"><link rel="prefetch" href="/uav-assess-vr/assets/js/13.374a8cb4.js"><link rel="prefetch" href="/uav-assess-vr/assets/js/14.0f827497.js"><link rel="prefetch" href="/uav-assess-vr/assets/js/15.16f32d93.js"><link rel="prefetch" href="/uav-assess-vr/assets/js/16.95896130.js"><link rel="prefetch" href="/uav-assess-vr/assets/js/17.0f23ed88.js"><link rel="prefetch" href="/uav-assess-vr/assets/js/19.457f2dca.js"><link rel="prefetch" href="/uav-assess-vr/assets/js/3.dcc01472.js"><link rel="prefetch" href="/uav-assess-vr/assets/js/4.22b167ee.js"><link rel="prefetch" href="/uav-assess-vr/assets/js/5.1827ef66.js"><link rel="prefetch" href="/uav-assess-vr/assets/js/6.f8cb9a94.js"><link rel="prefetch" href="/uav-assess-vr/assets/js/7.f2d0a320.js"><link rel="prefetch" href="/uav-assess-vr/assets/js/8.f794b5bb.js"><link rel="prefetch" href="/uav-assess-vr/assets/js/9.c668742b.js">
    <link rel="stylesheet" href="/uav-assess-vr/assets/css/0.styles.1a197325.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/uav-assess-vr/" class="home-link router-link-active"><!----> <span class="site-name">UAV Assess VR</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/uav-assess-vr/guide/" class="nav-link router-link-active">
  User Guide
</a></div><div class="nav-item"><a href="/uav-assess-vr/developer/" class="nav-link">
  Developer Guide
</a></div><div class="nav-item"><a href="https://oblot.pw.edu.pl/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  OBLot Research Centre
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/wut-daas/uav-assess-vr" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/uav-assess-vr/guide/" class="nav-link router-link-active">
  User Guide
</a></div><div class="nav-item"><a href="/uav-assess-vr/developer/" class="nav-link">
  Developer Guide
</a></div><div class="nav-item"><a href="https://oblot.pw.edu.pl/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  OBLot Research Centre
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/wut-daas/uav-assess-vr" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>User Guide</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/uav-assess-vr/guide/" aria-current="page" class="sidebar-link">Introduction</a></li><li><a href="/uav-assess-vr/guide/getting-started.html" class="sidebar-link">Getting started</a></li><li><a href="/uav-assess-vr/guide/autopilot-simulation.html" aria-current="page" class="active sidebar-link">Autopilot simulation</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/uav-assess-vr/guide/autopilot-simulation.html#prerequisites" class="sidebar-link">Prerequisites</a></li><li class="sidebar-sub-header"><a href="/uav-assess-vr/guide/autopilot-simulation.html#installation" class="sidebar-link">Installation</a></li><li class="sidebar-sub-header"><a href="/uav-assess-vr/guide/autopilot-simulation.html#running-the-simulation" class="sidebar-link">Running the simulation</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="autopilot-simulation"><a href="#autopilot-simulation" class="header-anchor">#</a> Autopilot simulation</h1> <div class="custom-block warning"><p class="custom-block-title">WARNING</p> <p>Using the whole ArduPilot flight stack may be a bit challenging, and is overkill for many situations. It is advised to read more AP documentation if any problems occur.</p></div> <h2 id="prerequisites"><a href="#prerequisites" class="header-anchor">#</a> Prerequisites</h2> <ul><li><a href="https://ardupilot.org/dev/docs/sitl-simulator-software-in-the-loop.html" target="_blank" rel="noopener noreferrer">ArduPilot SiTL<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, make sure to closely follow installation instructions.</li></ul> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>The following instrucions assume that you install SiTL in Linux (either netive or in a virtual machine). Any way of installing it will be OK, as long as you can communicate with the UE4 application over network. Generally, Linux installation tends to be much more convenient.</p></div> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p><a href="https://px4.io/" target="_blank" rel="noopener noreferrer">PX4<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> can also be used, because it utilizes the same MAVLink protocol for communication. Just output the messages through UDP to the same port as when using Ardupilot.</p></div> <h2 id="installation"><a href="#installation" class="header-anchor">#</a> Installation</h2> <p>After completing the SiTL setup you should have Git installed and know how to use it. If you decided to install SiTL in a different operating system than the UE4 application is running in, clone the <code>https://github.com/wut-daas/uav-assess-vr.git</code> repository.</p> <p>Once the repository is downloaded, open its directory, then <code>sim-host</code> subdirectory. Copy the files to appropriate locations, you can find these in comments in the first line. At the time of writing these are:</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">mkdir</span> -p ~/.mavproxy/joysticks/
<span class="token function">cp</span> frsky-usb.yml ~/.mavproxy/joysticks/

<span class="token function">mkdir</span> -p ~/.config/ardupilot/
<span class="token function">cp</span> locations.txt ~/.config/ardupilot/
</code></pre></div><h2 id="running-the-simulation"><a href="#running-the-simulation" class="header-anchor">#</a> Running the simulation</h2> <p>After completing the setup, the following command can be used to start the simulation from any directory. Replace <code>UE4IP</code> with the IP address of the system running the UE4 application.</p> <div class="language-bash extra-class"><pre class="language-bash"><code>sim_vehicle.py -v ArduCopter -L EPPZ-oblot --out udp:UE4IP:54001
</code></pre></div><h3 id="using-mavproxy"><a href="#using-mavproxy" class="header-anchor">#</a> Using MAVProxy</h3> <p>SiTL simulation will by default open <a href="https://ardupilot.org/dev/docs/copter-sitl-mavproxy-tutorial.html" target="_blank" rel="noopener noreferrer">MAVProxy<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, which is ground control station software targeted at Ardupilot developers. When ssing SiTL, another terminal window opens, which is labelled XTerm, usually with a more dated appearance. Ignore this terminal, input all your commands into MAVProxy running in the system terminal you started the simulation from.</p> <p>Loading these modules will probably be helpful:</p> <div class="language- extra-class"><pre class="language-text"><code>module load joystick
module load console
module load map
</code></pre></div><p>Start the UE4 application. If everything was se up correctly, you shouldn't see the yellow <code>No MAVLink connection</code> indicator in the bottom right of the screen. Input the following commands into MAVProxy and observe the result in UE4.</p> <div class="language- extra-class"><pre class="language-text"><code>mode guided
arm throttle
takeoff 2
</code></pre></div><p>In MAVProxy console window (a smaller GUI displaying status) you should see the Alt (altitude) value rising until it becomes around 2 meters. Meanwhile, in the UE4 application the drone should fluently move to the new altitude.</p> <h3 id="flying-the-uav"><a href="#flying-the-uav" class="header-anchor">#</a> Flying the UAV</h3> <p>If you have configured and connected a radio transmiter and loaded the <code>joystick</code> module, you can use it to fly the drone as usual. To be able to control it after automated takeoff, change the mode accordingly, e.g. to Loiter.</p> <div class="language- extra-class"><pre class="language-text"><code>mode loiter
</code></pre></div><hr> <p>If you don't have any device to act as R/C, you can still use the automatic flight modes. For example, stay in mode Guided, and load <code>map</code> module if not already loaded. By right-clicking inside the map and selecting <code>Fly to</code>, you can see how the visualisation performs.</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">7/5/2021, 9:19:08 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/uav-assess-vr/guide/getting-started.html" class="prev">
        Getting started
      </a></span> <!----></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/uav-assess-vr/assets/js/app.d990a396.js" defer></script><script src="/uav-assess-vr/assets/js/2.f9356c91.js" defer></script><script src="/uav-assess-vr/assets/js/18.611d644b.js" defer></script>
  </body>
</html>
